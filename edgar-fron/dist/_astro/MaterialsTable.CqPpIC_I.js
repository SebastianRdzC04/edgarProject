import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as t}from"./index.BVOCwoKb.js";function b({isOpen:a,onClose:x,onSuccess:f}){const[i,o]=t.useState(""),[m,h]=t.useState(""),[l,u]=t.useState(!1),[n,c]=t.useState({show:!1,type:"",message:""}),d={base:{padding:"10px",marginBottom:"16px",borderRadius:"4px"},success:{backgroundColor:"#d1fae5",color:"#065f46"},error:{backgroundColor:"#fee2e2",color:"#b91c1c"}},g={display:"inline-block",marginRight:"8px",animation:"spin 1s linear infinite"},p=(s,r)=>{c({show:!0,type:s,message:r}),setTimeout(()=>{c({show:!1,type:"",message:""})},3e3)},j=async s=>{s.preventDefault(),u(!0);try{const r=localStorage.getItem("token"),y=await fetch("https://apiedgar.kysedomi.lat/materials/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:i,description:m})}),w=await y.json();if(!y.ok)throw new Error(w.message||"Error al crear el material");p("success","Material creado exitosamente"),o(""),h(""),x(),f()}catch(r){p("error",r.message||"Ocurrió un error al crear el material")}finally{u(!1)}};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 relative",children:[e.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
          `}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Nuevo Material"}),e.jsx("button",{onClick:x,className:"text-gray-500 hover:text-gray-800 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.show&&e.jsx("div",{style:{...d.base,...n.type==="success"?d.success:d.error},children:n.message}),e.jsxs("form",{onSubmit:j,className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Nombre del material"}),e.jsx("input",{id:"name",type:"text",placeholder:"Ej: Cemento, Varilla, etc.",value:i,onChange:s=>o(s.target.value),required:!0,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700",children:"Descripción"}),e.jsx("textarea",{id:"description",placeholder:"Descripción detallada del material",value:m,onChange:s=>h(s.target.value),required:!0,rows:4,className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("button",{type:"submit",disabled:l,className:`mt-2 px-4 py-2 bg-blue-600 text-white font-medium rounded-md ${l?"opacity-70 cursor-not-allowed":"hover:bg-blue-700"} transition-colors`,children:l?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{style:g,children:"◌"}),"Guardando..."]}):"Guardar Material"})]})]})}):null}const k=()=>{const[a,x]=t.useState([]),[f,i]=t.useState(!0),[o,m]=t.useState(null),[h,l]=t.useState(!1),[u,n]=t.useState(!1),c=async()=>{i(!0);try{const s=await fetch("https://apiedgar.kysedomi.lat/materials/");if(!s.ok)throw new Error("Failed to fetch materials");const r=await s.json();x(r)}catch(s){m(s instanceof Error?s.message:"An error occurred")}finally{i(!1)}};t.useEffect(()=>{c()},[]);const d=()=>{n(!0),setTimeout(()=>{n(!1)},3e3)},g=()=>l(!0),p=()=>l(!1),j=()=>{c().then(()=>{d()})};return f?e.jsx("div",{className:"overflow-hidden bg-white shadow-md rounded-xl w-full p-6",children:e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-gray-800"})})}):o?e.jsx("div",{className:"overflow-hidden bg-white shadow-md rounded-xl w-full p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3 h-40 text-red-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("p",{className:"text-lg font-medium",children:["Error: ",o]})]})}):e.jsxs("div",{className:"overflow-hidden bg-white shadow-md rounded-xl w-full",children:[u&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 shadow-md rounded z-50 animate-fadeIn",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("p",{className:"font-medium",children:"¡Material creado y lista actualizada con éxito!"})]})}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.3s ease-in-out;
        }
      `}),e.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-800 text-white flex justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold",children:["Materiales ",e.jsx("span",{className:"text-blue-300",children:"Disponibles"})]}),e.jsx("p",{className:"mt-2 text-gray-300",children:"Lista completa de materiales para construcción."})]}),e.jsx("div",{children:e.jsxs("button",{onClick:g,className:"px-4 py-2 bg-blue-300 text-black font-bold rounded-lg hover:bg-blue-400 transition duration-300 flex items-center shadow-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"Nuevo Material"]})})]}),e.jsx("div",{className:"w-full",children:e.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Descripción"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.length>0?a.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:s.description})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{className:"px-3 py-1.5 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors",children:"Detalles"})})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-10 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No hay materiales disponibles"})]})})})})]})}),a.length>0&&e.jsxs("div",{className:"px-6 py-4 bg-gray-100 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:a.length})," materiales en total"]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{className:"px-3 py-1.5 bg-gray-800 text-white border border-gray-800 rounded hover:bg-gray-700 transition-colors",children:"Exportar"})})]}),e.jsx(b,{isOpen:h,onClose:p,onSuccess:j})]})};export{k as default};
